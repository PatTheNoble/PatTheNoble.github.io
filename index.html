<!DOCTYPE html>

<html lang="en" class="PM">
    <title> Patrick Morris' Personal Page</title>
<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="alternate icon" href="favicon.ico">
    <link rel="mask-icon" href="favicon.svg" color="#ff8a01">
</head>

<body>
    <nav id="navbar" class="PM">
        <span class="PM"><a href="#home">Home</a></span>
        <span class="PM"><a href="#about">About</a></span>
        <span class="PM"><a href="#tech-stack">Skills</a></span>
        <span class="PM"><a href="#portfolio">Portfolio</a></span>
        <span class="PM hamburger"><a href="#home"><img src="Hamburger.svg" alt="Hamburger" style="width: 25px;"></a></span>
    </nav>

    <aside class="left-bar">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </aside>
    <aside class="gear-container">
        <img src="Gear.svg" alt="Gear" class="gear" style="left: 150px; top: -250px;">
    </aside>
    <p class="name">
        Patrick Morris
    </p>
    

    <section id="home" class="content">
        <img src="Patrick2.jpg" alt="Picture of me" class="profile" onclick=getRepos()>
    </section>

    <section id="about" class="content">
        <h1>About: </h1>
        <div class="about">
            I am Patrick Morris: Indie Game Developer, Web Developer, Artist, Programmer, Gamer. I am not your average
            developer... Lorem Ipsum delore blablabla
        </div>
    </section>

    <section id="tech-stack" class="content">
        <h1>Tech Stack:</h1>
        <div class="skills grid-container">
            <div>
                <img src="React.svg" alt="React" class="PM skills grid-item"></img>
                <p>React</p>
            </div>
            <div>
                <img src="CSS3.svg" alt="CSS3" class="PM skills grid-item"></img>
                <p>CSS3</p>
            </div>
            <div>
                <img src="HTML5.svg" alt="HTML5" class="PM skills grid-item"></img>
                <p>HTML5</p>
             </div>
            <div>
                <img src="Nextjs.svg" alt="Next.js" class="PM skills grid-item"></img>
                <p>Next.js</p>
            </div>
            <div>
                <img src="JQuery.svg" alt="JQuery" class="PM skills grid-item"></img>
                <p>JQuery</p>
             </div>
            <div>
                <img src="JS.svg" alt="Java Script" class="PM skills grid-item"></img>
                <p>Java Script</p>
            </div>
            <div>
                <img src="Git.svg" alt="Git" class="PM skills grid-item"></img>
                <p>Git</p>
            </div>
            <div>
                <img src="Github.svg" alt="Github" class="PM skills grid-item"></img>
                <p>Github</p>
            </div>      
        </div>
    </section>

    
    <aside class="gear-container">
        <img src="Gear.svg" alt="Gear" class="gear" style="left: 50px; top: -250px">
        <img src="Gear.svg" alt="Gear" class="gear" style="right: -350px; top: -550px;">
        <br><br><br><br><br><br><br><br>
    </aside>

    <section id="portfolio">
        <div class="content">
            <h1>Portfolio:</h1>
            <p>
                The projects below are all pulled directly off of my <a href="https://github.com/PatTheNoble">github page</a> using the Github Rest API. 
                You can find the code <a href="https://github.com/PatTheNoble/PatTheNoble.github.io">here:</a>
            </p>
        </div>
        <!-- 
            Portfolio items are inserted here through JS.
        -->
    </section>



    <script type="module">
        import { Octokit } from "https://cdn.skypack.dev/@octokit/core";
        /* When the user scrolls down, hide the navbar. When the user scrolls up, show the navbar */
        /*
        var prevScrollpos = window.pageYOffset;
        window.onscroll = function () {
            var currentScrollPos = window.pageYOffset;
            if (prevScrollpos > currentScrollPos) {
                document.getElementById("navbar").style.top = "0";
            } else {
                document.getElementById("navbar").style.top = "-60px";
            }
            prevScrollpos = currentScrollPos;
        }
        */
        async function getRepos() {
            const octokit = new Octokit({ auth: "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" });

            // const response2 = await octokit.request('GET /repos/{owner}/{repo}/community/profile', {
            //     owner: 'PatTheNoble',
            //     repo: 'PatTheNoble'
            // });
            // console.log(response2);

            // const requestCurrentFile = await octokit.request('GET /repos/{owner}/{repo}/contents/{path}', {
            //     owner: 'PatTheNoble',
            //     repo: 'to-do-list',
            //     path: 'README.md'
            // });
            // console.log(requestCurrentFile);

            const response = await octokit.request('GET /user/repos');
            console.log(response.data);

            const portfolioList = document.createElement("div");
            portfolioList.classList.add("portfolio-container");
            document.getElementById("portfolio").appendChild(portfolioList);
            for(var i = 0; i < response.data.length; i++)
            {
                var currentName = response.data[i].name;

                var textnode = document.createElement("div");
                var portfolioTitle = document.createElement("h1");
                portfolioTitle.innerText = currentName;
                //textnode.classList.add("game");
                try{
                    await octokit.request('GET /user/starred/{owner}/{repo}', {
                        owner: 'PatTheNoble',
                        repo: currentName
                    })
                    try {
                        const readMeRespose = await octokit.request('GET /repos/{owner}/{repo}/readme', {
                            accept: "application/vnd.github.v3.raw",
                            owner: 'PatTheNoble',
                            repo: currentName
                        });
                        //console.log( atob(readMeRespose.data.content));
                        textnode.innerHTML = atob(readMeRespose.data.content); //atob function decodes the base64 encoding.
                        portfolioList.appendChild(textnode);
                        textnode.prepend(portfolioTitle);
                    } 
                    catch(err) {
                        console.log(err);
                    }
                }
                catch(err) {
                    console.log(currentName, " was not starred and will not be included.");
                }
            }
        }
        getRepos();
    </script>
</body>

</html>